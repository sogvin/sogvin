<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="stylesheet" type="text/css" href="theme.css"/>
<link rel="stylesheet" type="text/css" href="a4.css"/>

</head>
<body>
<header><code>Test - <a href="index.html">
Software Engineering
</a>
</code></header><article>
<h1>Inline test helpers</h1>
<p>Use inline test helpers to minimize indentation and have
       failures point out failed cases directly.
</p>
<div class="boxnote" style="margin-top: 0.8cm">Inlined helper does not need t argument.</div><div class="boxnote" style="margin-top: 5.6cm">Descriptive cases fail on correct line.</div><pre class="srcfile"><code class="go">func Test_double(t *testing.T) {
	ok := func(input, exp int) {
		t.Helper()
		got, err := double(input)
		if err != nil {
			t.Error(err)
		}
		if got != exp {
			t.Errorf("double(%v) returned %v, expected %v", input, got, exp)
		}
	}
	// cases
	ok(1, 2)
	ok(3, 6)
	ok(MAX, MAX)

	bad := func(input, exp int) {
		t.Helper()
		_, err := double(input)
		if err == nil {
			t.Errorf("double(%v) should fail", input)
		}
	}
	bad(-2, 4)
}

// double returns the double of i if i is positive but never more than
// max int
func double(i int) (int, error) {
	if i < 0 {
		return 0, fmt.Errorf("double: i must be positive")
	}
	n := i * 2
	if n < i {
		return MAX, nil
	}
	return n, nil
}

const MAX int = int(^uint(0) >> 1)
</code></pre><div class="boxnote" style="margin-top: 0.2cm">Utmost 2 inlined helpers.</div><p>Keep it simple and use utmost two inlined helpers. Compared to
       table-driven-tests inlined helpers declare the <em>how</em>
       before the cases.  If you have many cases, this style is more
       readable as you first tell the reader the meaning of
       &#34;ok&#34; and &#34;bad&#34;.  <br> Another positive benefit
       of this style is values are not grouped in a testcase
       variable. I.e. readability improves as the values are used
       directly.  <br>This style may be less readable if each case
       requires many values, though it depends on the lenght of the
       values combined.
</p>

</article><footer>Gregory Vin&ccaron;i&cacute;</footer>
</body>
</html>