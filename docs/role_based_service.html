<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="stylesheet" type="text/css" href="theme.css"/>
<link rel="stylesheet" type="text/css" href="a4.css"/>
<title>Role based service - Software Engineering</title>
</head>
<body>
<header><code>Design - <a href="index.html">Software Engineering</a></code></header>
<article>
<h1>Role based service</h1>
<p>Services running on cloud servers mostly provide API's
	    through the HTTP protocol and are often sizeable
	    applications. Without a clear design they become hard to
	    maintain over time. Moreover their features need protecting
	    from unauthorized access. This protection can be defined in
	    roles.  I'll explore one such design and elaborate on the
	    naming with an example service for navigating the stars.</p>
<nav><ul>
<li class="h2"><a href="#domaindescriptionnavigatingthestars">Domain description - Navigating the stars</a></li>
<li class="h3"><a href="#conceptelicitation">Concept elicitation</a></li>
<li class="h2"><a href="#systemdesign">System design</a></li>
<li class="h3"><a href="#packagenaming">Package naming</a></li>
<li class="h3"><a href="#navstarpackage">Navstar package</a></li>
<li class="h2"><a href="#httpprogramminginterface">HTTP programming interface</a></li>
<li class="h2"><a href="#application">Application</a></li>
<li class="h2"><a href="#summary">Summary</a></li>
</ul>
</nav>
<p>Code examples found below you can view at <a href="https://github.com/gregoryv/navstar">gregoryv/navstart</a>.</p>
<h2 id="domaindescriptionnavigatingthestars"><a href="#domaindescriptionnavigatingthestars">Domain description - Navigating the stars</a></h2>
<p>Before we go into the design, let me tell you about the
        business of navigating through the galaxy. By describing the
        domain we'll be able to elicit concepts and features for our
        system design.</p>
<div class="figure"><img src="img/galaxytravel.png"/></div>
<p>The company <b>Future Inc.</b> provides people means to
	    travel the Milky Way. Customers, browse and order trips on <code>galaxytravel.future.now</code>. Destinations are cataloged
	    and presented adventurously with specifications of distance,
	    travel time, ship details as well as a captains profile.<br/>The ships captain uses the same service to plan the
	    entire flight. He submits a flight plan just days before
	    departure to make sure it's as accurate as possible since
	    space travel is not an exact science and there are lot of
	    unknown objects about. Luckily the navigation system provides
	    the pilots with all the information they need. Once the plan
	    has been submitted, passengers can view route details,
	    including interesting waypoints. Crew members also access the
	    details of routes and possible alternatives, should there be
	    an unforseen cosmic event.</p>
<p>Now that we know a bit about the domain we'll be working
	    in, lets find the important concepts and focus on the ones
	    part of navigating the stars.</p>
<h3 id="conceptelicitation"><a href="#conceptelicitation">Concept elicitation</a></h3>
<p>We know the service is found at
	    galaxytravel.future.com. This is a domain name selected
	    because it sounds great and is easily remembered by customers
	    when they want to elope to another part of the galaxy, think
	    Luke Skywalker in a bar. It has very little to do with
	    navigating the stars though so we should exclude that name or
	    part of it in our design. Reason about the words in your
	    domain before deciding on how to use them. Refactoring code is
	    easy compared to changing peoples perception of concepts.</p>
<p>Several people are interacting with the service; customers,
	    captain, crew members and passengers. Let's exclude the
	    customer as that is a role more related to booking. This
	    leaves us passenger, captain and crew members. Obviously the
	    passenger is a customer at some point but the word customer is
	    irrelevant when it comes to navigating the stars. A passenger
	    however, has access to viewing parts of the flight plan, which
	    leads us to enumerating the features of our navigation
	    service.</p>
<p>We recognize that the galaxytravel service, serves both
	    customers and captains though with different purpose. In our
	    design we'll separate these into different systems and focus
	    on the system that provides features for maninpulating
	    flightplans. The captain submits a flightplan whereas, other
	    crew members and passengers can view it. Passengers can see
	    the designated route, with details such as current location,
	    waypoints and estimated time of arrival.</p>
<p>Let's summarize by grouping the concepts</p>
<dl>
<dt>Role</dt>
<dd>passenger, captain, crew member</dd>
<dt>Rsource</dt>
<dd>flightplan, route, waypoint</dd>
<dt>Feature</dt>
<dd>submit flightplan, view flightplan</dd>
</dl><p>Note that up until now all the terminology is from the
    	domain of navigating the stars. The only term used that
    	somehow relates to a software is "system". Which we'll design
    	now.</p>
<h2 id="systemdesign"><a href="#systemdesign">System design</a></h2>
<p>The first thing we need is a name for the package or module
	    that will contain the source code of our software.</p>
<h3 id="packagenaming"><a href="#packagenaming">Package naming</a></h3>
<p>One way to figure out a good name is to try to write that
	    one line package documentation sentence. <em>"Package X
	    provides ..."</em></p>
<em>"Package galaxytravel provides applications for planning
	    star navigation"</em><p>Sounds ok, but wait, we said that the service name
	    galaxytravel was selected for customers and should be excluded
	    from the navigation system. Also it as a service provides more
	    than just applications for planning star navigation. How
	    about</p>
<em>"Package starnavigation provides means to plan galaxy flights"</em><p>Short sentence which abstracts what it provides by using
	    the word "means" and is more specific by using "plan galaxy
	    flights". One problem though, the name "starnavigation" is a
	    mouthful, with five syllables. The name will be used
	    extensively and we should try to find something
	    shorter. Maybe</p>
<div class="sidenote" style="margin-top: 0cm"><div class="inner">Short pronounce- able package name</div>
</div>
<em>"Package navstar provides a system for planning galaxy flights"</em><p>Short pronouncable name, mentions the system and its main
	    purpose. It allows for easy discussion and ties into the
	    domain terminology nicely. Let's stick with it for now.</p>
<h3 id="navstarpackage"><a href="#navstarpackage">Navstar package</a></h3>
<p>Navstar implements domain logic related to planning galaxy
	    flights. It's at the core of our design. Later we'll build
	    other layers on top of it.</p>
<div class="figure"><svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  font-family="Arial,Helvetica,sans-serif" width="275" height="224">
<path stroke="#d3d3d3" fill="#ffffff" d="M100,120 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="100" y="149">navstar</text>
<path stroke="#d3d3d3" fill="#e2e2e2" d="M164,93 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="184" y="122"></text>
<path stroke="#d3d3d3" fill="#e2e2e2" d="M100,66 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="120" y="95"></text>
<path stroke="#d3d3d3" fill="#e2e2e2" d="M164,39 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="184" y="68"></text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="0" y="217">Navstar is the core package
	    with domain logic</text></svg></div>
<p>The type system is the most prominent abstraction the
	    navstar package provides. It's responsible for synchronizing
	    database access and other domain related configuration. There
	    would usually only exist one instance of the system in any
	    running application.</p>
<div class="filename"><a href="https:/github.com/gregoryv/navstar/blob/main/system.go">navstar/system.go</a></div>
<pre class="srcfile complete"><code class="go">package navstar

func NewSystem() *System {
	return &System{}
}

// System provides logic for reading and writing navstar related
// resources.
type System struct {
	// e.g. database, sync mutexes
}
</code></pre><p>Roles expose access to user methods. Fairly often we talk
	    about what we can do with a system, referring to you and me as
	    users.</p>
<em>- Pilots submit flightplan</em><br/><em>- Passengers and crew member view flightplans</em><p>This translates to SubmitFlightplan is implemented by type
	    user and accessible via the pilot role. Also ListFlightplans
	    is implemented by type user but accessible by roles pilot,
	    passenger and crew member.</p>
<div class="figure"><svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  font-family="Arial,Helvetica,sans-serif" width="528" height="334">
<path stroke="black" stroke-dasharray="5,5,5" d="M406,179 L312,104" />
<g transform="rotate(218 312 104)"><path stroke="black" fill="#ffffff" d="M312,104 l-8,-4 l 0,8 Z" /></g>

<path stroke="black" stroke-dasharray="5,5,5" d="M260,174 L260,104" />
<g transform="rotate(-90 260 104)"><path stroke="black" fill="#ffffff" d="M260,104 l-8,-4 l 0,8 Z" /></g>

<path stroke="black" stroke-dasharray="5,5,5" d="M116,179 L208,104" />
<g transform="rotate(-39 208 104)"><path stroke="black" fill="#ffffff" d="M208,104 l-8,-4 l 0,8 Z" /></g>

<rect stroke="#d3d3d3" fill="#ffffff" x="193" y="20" width="135" height="84"/>
<line stroke="#d3d3d3" x1="193" y1="46" x2="328" y2="46"/><text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="199" y="62">ListFlightplans()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="199" y="78">SubmitFlightplan()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="199" y="94">setUser()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="199" y="36">navstar.Role interface</text>
<rect stroke="#d3d3d3" fill="#ffffff" x="0" y="174" width="116" height="106"/>
<line stroke="#d3d3d3" x1="0" y1="200" x2="116" y2="200"/><text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="6" y="216">User</text>
<line stroke="#d3d3d3" x1="0" y1="222" x2="116" y2="222"/><text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="6" y="238">ListFlightplans()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="6" y="254">SubmitFlightplan()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="6" y="270">Use()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="6" y="190">navstar.Pilot struct</text>
<rect stroke="#d3d3d3" fill="#ffffff" x="186" y="174" width="150" height="106"/>
<line stroke="#d3d3d3" x1="186" y1="200" x2="336" y2="200"/><text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="192" y="216">User</text>
<line stroke="#d3d3d3" x1="186" y1="222" x2="336" y2="222"/><text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="192" y="238">ListFlightplans()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="192" y="254">SubmitFlightplan()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="192" y="270">Use()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="192" y="190">navstar.Passenger struct</text>
<rect stroke="#d3d3d3" fill="#ffffff" x="406" y="174" width="120" height="106"/>
<line stroke="#d3d3d3" x1="406" y1="200" x2="526" y2="200"/><text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="412" y="216">User</text>
<line stroke="#d3d3d3" x1="406" y1="222" x2="526" y2="222"/><text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="412" y="238">ListFlightplans()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="412" y="254">SubmitFlightplan()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="412" y="270">Use()</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="412" y="190">navstar.Crew struct</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="144" y="327">Different roles provide
		different methods</text></svg></div>
<p>We start of by defining all roles in one file together with
	    the interface, showing partial content below. The reason being
	    that roles change together, ie. if we define a new feature
	    method, all roles need updating.</p>
<div class="filename"><a href="https:/github.com/gregoryv/navstar/blob/main/role.go">navstar/role.go</a></div>
<pre class="srcfile"><code class="go">type Role interface {
	SubmitFlightplan(route Flightplan) error
	ListFlightplans() ([]Flightplan, error)
	setUser(v *User)
}

// ----------------------------------------

type Pilot struct {
	*User
}

func (me *Pilot) SubmitFlightplan(v Flightplan) error {
	return me.submitFlightplan(v)
}

func (me *Pilot) ListFlightplans() ([]Flightplan, error) {
	return me.listFlightplans()
}

func (me *Pilot) setUser(v *User) {
	me.User = v
}
</code></pre><p>This design provides well defined places to implement
	    future features. Assume the navstar service should provide
	    planet information to users.</p>
<ol>
<li>Define resource Planet</li>
<li>Implement feature methods on type user, e.g.<ul>
<li><code>viewPlanet(name string)</code></li>
<li><code>savePlanet(v Planet) error</code></li>
</ul>
</li>
<li>Expose user methods to selected roles</li>
</ol>
<p>Note that authentication is not part of this design,
	    i.e. translating some user credentials into one specific
	    role. The reason is that authentication is not part of the
	    navstar domain.</p>
<p>At this point the navstar system is fairly well designed
	    and we know how to extend it with new features. It's time to
	    expose the navstar system through a HTTP programming
	    interface.</p>
<h2 id="httpprogramminginterface"><a href="#httpprogramminginterface">HTTP programming interface</a></h2>
<p>At this stage I haven't decided on a specific design for
		the interface. I know however that talking about this part of
		the design; we will use wording like "navstar webapi",
		"navstar httpapi" or even simply "navstar api". Now, a name
		like webapi or api alone seems a bit to generic as HTTP is not
		the only protocol available to us. Httpapi is a mouthful so
		we'll shorten it to <em>htapi</em>.</p>
<div class="figure"><svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  font-family="Arial,Helvetica,sans-serif" width="286" height="224">
<path stroke="#d3d3d3" fill="#e2e2e2" d="M100,120 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="100" y="149">navstar</text>
<path stroke="#d3d3d3" fill="#ffffff" d="M164,93 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="170" y="122">htapi</text>
<path stroke="#d3d3d3" fill="#e2e2e2" d="M100,66 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="120" y="95"></text>
<path stroke="#d3d3d3" fill="#e2e2e2" d="M164,39 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="184" y="68"></text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="0" y="217">htapi package is separated
		from the core navstar</text></svg></div>
<p>The htapi provides a router that exposes the navstar
	    features using its system and roles. Resources are accessible
	    via different URLs. The routing of a url to a specific server
	    method is handled by the muxer. Note how in this layer we are
	    increasingly using terms outside of the domain and more
	    technical, which is perfectly ok.</p>
<div class="filename"><a href="https:/github.com/gregoryv/navstar/blob/main/htapi/router.go">navstar/htapi/router.go</a></div>
<pre class="srcfile"><code class="go">// Package htapi exposes the navstar system via HTTP.
package htapi

import (
	"encoding/json"
	"net/http"

	"github.com/gregoryv/navstar"
)

func NewRouter(sys *navstar.System) *Router {
	mux := http.NewServeMux()
	r := Router{sys: sys, mux: mux}
	mux.HandleFunc("/flightplans", r.serveFlightplans)
	return &r
}

type Router struct {
	sys *navstar.System
	mux *http.ServeMux
}
</code></pre><p>A request from a client such as a browser would follow the
	    below sequence.</p>
<svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  font-family="Arial,Helvetica,sans-serif" width="636" height="450">
<rect stroke="black" stroke-width="0" fill="#ff9999" fill-opacity="0.1" x="312" y="24" width="280" height="372"/>
<text class="area-red-title" font-size="12px" x="318" y="42"></text>
<rect stroke="black" stroke-width="0" fill="#99e6ff" fill-opacity="0.1" x="172" y="24" width="140" height="372"/>
<text class="area-blue-title" font-size="12px" x="178" y="42"></text>
<line stroke="#d3d3d3" x1="32" y1="24" x2="32" y2="354"/>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="10" y="18">browser</text>
<line stroke="#d3d3d3" x1="172" y1="24" x2="172" y2="354"/>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="139" y="18">htapi.Router</text>
<line stroke="#d3d3d3" x1="312" y1="24" x2="312" y2="354"/>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="278" y="18">navstar.Role</text>
<text font-style="italic" font-family="Arial,Helvetica,sans-serif" font-size="12px" x="196" y="389">Protected by role</text>
<line stroke="#d3d3d3" x1="452" y1="24" x2="452" y2="354"/>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="418" y="18">navstar.User</text>
<line stroke="#d3d3d3" x1="592" y1="24" x2="592" y2="354"/>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="551" y="18">navstar.System</text>
<text font-style="italic" font-family="Arial,Helvetica,sans-serif" font-size="12px" x="418" y="389">Unprotected</text>
<path stroke="black" d="M32,57 L172,57" />
<g transform="rotate(0 172 57)"><path stroke="black" fill="#ffffff" d="M172,57 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="59" y="54">GET /flightplans</text>
<line stroke="black" x1="172" y1="90" x2="187" y2="90"/>
<line stroke="black" x1="187" y1="90" x2="187" y2="122"/>
<path stroke="black" d="M187,122 L172,122" />
<g transform="rotate(180 172 122)"><path stroke="black" fill="#ffffff" d="M172,122 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="193" y="109">serveFlightplans() via muxer</text>
<path stroke="black" d="M172,145 L312,145" />
<g transform="rotate(0 312 145)"><path stroke="black" fill="#ffffff" d="M312,145 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="217" y="142">new: role</text>
<path stroke="black" d="M172,178 L452,178" />
<g transform="rotate(0 452 178)"><path stroke="black" fill="#ffffff" d="M452,178 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="285" y="175">new: user</text>
<path stroke="black" d="M172,211 L452,211" />
<g transform="rotate(0 452 211)"><path stroke="black" fill="#ffffff" d="M452,211 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="251" y="208">user.Use(system, role)</text>
<path stroke="black" d="M172,244 L312,244" />
<g transform="rotate(0 312 244)"><path stroke="black" fill="#ffffff" d="M312,244 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="198" y="241">ListFlightplans()</text>
<path stroke="black" d="M312,277 L452,277" />
<g transform="rotate(0 452 277)"><path stroke="black" fill="#ffffff" d="M452,277 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="340" y="274">listFlightplans()</text>
<path stroke="black" d="M452,310 L592,310" />
<g transform="rotate(0 592 310)"><path stroke="black" fill="#ffffff" d="M592,310 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="479" y="307">query database</text>
<path stroke="black" d="M172,343 L32,343" />
<g transform="rotate(180 32 343)"><path stroke="black" fill="#ffffff" d="M32,343 l-8,-4 l 0,8 Z" /></g>

<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="51" y="340">write http response</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="203" y="443">Using navstar system via a HTTP interface</text></svg><p>The router only propagates the request down to the muxer
		which is an implementation detail and can be freely replaced
		if needed. This way the router references everything needed by
		the handler functions which are bound to it.</p>
<div class="filename"><a href="https:/github.com/gregoryv/navstar/blob/main/htapi/router.go">navstar/htapi/router.go</a></div>
<pre class="srcfile"><code class="go">func (me *Router) ServeHTTP(w http.ResponseWriter, r *http.Request) {
	me.mux.ServeHTTP(w, r)
}

func (me *Router) serveFlightplans(w http.ResponseWriter, r *http.Request) {
	var role navstar.Role = getRole(r)
	var user navstar.User
	user.Use(me.sys, role)

	plans, _ := role.ListFlightplans()
	json.NewEncoder(w).Encode(plans)
}

// getRole returns a role implementation based on the incomming
// request. This one just looks for the query parameter role. Defaults
// to the passenger role.
func getRole(r *http.Request) navstar.Role {
	switch r.URL.Query().Get("role") {
	case "pilot":
		return &navstar.Pilot{}
	case "crew":
		return &navstar.Crew{}
	default:
		return &navstar.Passenger{}
	}
}
</code></pre><p>We can keep on developing this layer until we think it's
		ready to let other people start using it. This would be the
		time you think about designing for deployment, performance and
		maintainers. I won't go into those areas here. Let's focus on
		the design for one particular application we intend to deliver
		that can be hosted on some server in the cloud.</p>
<h2 id="application"><a href="#application">Application</a></h2>
<p>With our domain logic in one package and the exposing http
	    layer in another we want to provide a command that handles
	    requests over the internet. The Go language build system
	    defaults to folder names when building and often these
	    command-folders are found under the folder
	    <code>cmd/</code>. We can use the same method to find a good
	    name for the package holding the application. After some
	    interations I ended up with with the name <em>starplan</em>.</p>
<div class="figure"><svg
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  font-family="Arial,Helvetica,sans-serif" width="321" height="224">
<path stroke="#d3d3d3" fill="#e2e2e2" d="M100,120 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="100" y="149">navstar</text>
<path stroke="#d3d3d3" fill="#e2e2e2" d="M164,93 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="170" y="122">htapi</text>
<path stroke="#d3d3d3" fill="#e2e2e2" d="M100,66 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text class="dim-title" font-size="12px" x="108" y="95">cmd</text>
<path stroke="#d3d3d3" fill="#ffffff" d="M164,39 l 40,0 20,25 -20,25 -40,0 -20,-25 20,-25" />
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="162" y="68">starplan</text>
<text font-family="Arial,Helvetica,sans-serif" font-size="12px" x="0" y="217">Command starplan exposes
		the htapi via a TCP server.</text></svg></div>
<p>The reason you shouldn't name it e.g. "navstar" is that the
	    domain of navigating stars will grow and you probably want to
	    expose parts of it differently, thus having multiple
	    commands.<br/>Adding files for some of the mentioned
	    abstractions we end up with a directory tree like this</p>
<pre class="command"><code>$ tree navstar
navstar
├── cmd
│   └── starplan
│       └── main.go
├── htapi
│   └── router.go
├── package.go
├── resource.go
├── role.go
├── system.go
└── user.go

</code></pre><h2 id="summary"><a href="#summary">Summary</a></h2>
<p>Separating the domain logic from, the application exposing
	    it, allows your service to grow more easily. By naming
	    components carefully we can reason about concepts such as
	    the-galaxytravel-service, navstar-system and
	    starplan-application, which are all easily referencable in the
	    source code aswell. Aim to have a few, but well defined
	    crossing points between the layers. Starplan uses htapi and
	    navstar, whereas htapi only uses the navstar package.</p>
<p>Try not to design all the layers simultaneously as it's
		easier to reason about one purpose. Start with the business
		domain logic and work outwards throught the layers.</p>
<em>See you in the stars!</em></article>
<footer>Gregory Vin&ccaron;i&cacute;</footer></body>
</html>
